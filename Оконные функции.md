# Функции ранжирования  
<br>

## RANK  
Перед нами задача, составить рейтинг фильмов за декабрь 1990 г. по продолжительности.
<br>

```Было```
``` 
Title                              |Genre      |Duration|
-----------------------------------+-----------+--------+
Man forward.                       |Adventure  |     179|
Phone door.                        |Action     |     178|
Hot recently trip.                 |Comedy     |     178|
Future say bad.                    |Thriller   |     176|
From look.                         |Horror     |     176|
Question myself.                   |Fantasy    |     176|
Hour image special.                |Fantasy    |     173|
What boy.                          |Sci-Fi     |     172|
Democrat front.                    |Sci-Fi     |     168|
Point point.                       |Sci-Fi     |     163|
Yourself fear admit.               |Documentary|     163|
Message from.                      |Adventure  |     160|
Mother computer.                   |Fantasy    |     158|
Particular outside easy.           |Thriller   |     153|
Open participant painting practice.|Adventure  |     151|
Rest join upon.                    |Documentary|     151|
```
<br>

```Стало```
```
RANK|Title                              |Genre      |Duration
----+-----------------------------------+-----------+--------
   1|Man forward.                       |Adventure  |     179
   2|Phone door.                        |Action     |     178
   2|Hot recently trip.                 |Comedy     |     178
   4|Future say bad.                    |Thriller   |     176
   4|From look.                         |Horror     |     176
   4|Question myself.                   |Fantasy    |     176
   7|Hour image special.                |Fantasy    |     173
   8|What boy.                          |Sci-Fi     |     172
   9|Democrat front.                    |Sci-Fi     |     168
  10|Point point.                       |Sci-Fi     |     163
  10|Yourself fear admit.               |Documentary|     163
  12|Message from.                      |Adventure  |     160
  13|Mother computer.                   |Fantasy    |     158
  14|Particular outside easy.           |Thriller   |     153
  15|Open participant painting practice.|Adventure  |     151
  15|Rest join upon.                    |Documentary|     151
```
Обратите вниманиеЮ фильмы с одинаковой продолжительностью получили один и тот же рейтинг, например, "Phone door" и "Hot recently trip". Для того, чтобы перейти от ```Было``` к ```Стало``` в первую очередь нужно отсортировать таблицу по убыванию продолжительности фильма. Дальше нам нужно спускаться вниз построчно и "смотреть" на одно поле, **Duration** (продолжительность). В принципе, мы можем назвать эти значения окном, хотя это и не совсем так, но пока нам этого достаточно. Теперь нужно перенести эту логику на SQL. Взглянем для начала на запрос без оконной функции.  
<br>

```Было```
```
SELECT Title,
	   Genre,
	   Duration	      
  FROM movies
 WHERE 1 = 1
   AND EXTRACT(YEAR FROM "Release Date") = 1990
   AND EXTRACT(month FROM "Release Date") = 12
 ORDER BY Duration DESC
```
